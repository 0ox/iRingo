#!name= Unlock Apple News 🇺🇸US
#!desc=解锁🇺🇸US地区的News，注：使用过程中gateway.icloud.com需走代理线路。

[Rule]
# > iCloud
DOMAIN,gateway.icloud.com,🇺🇸美国

# > Apple News
DOMAIN,news-client.apple.com,🇺🇸美国
# DOMAIN,news-client-search.apple.com,🇺🇸美国
DOMAIN,news-edge.apple.com,🇺🇸美国
DOMAIN,news-events.apple.com,🇺🇸美国
DOMAIN,apple.comscoreresearch.com,🇺🇸美国
# News+ Audio
URL-REGEX,^https?:\/\/news-assets\.apple\.com\/.*(audio-narrative).*,🇺🇸美国

[URL Rewrite]
# Redirect Apple News, Redirect StoreFront to US (143441)
# (^https?:\/\/news-client-search\.apple\.com)(\/v1\/search\?)(.*)(parsecParameters=)(.*)(storeFront%22:%22)([\d]{6})(-[\d]{1,2},[\d]{1,2}%22,)(.*) $1$2$3$4$5$6143441$8$9 header
(^https?:\/\/news-client-search\.apple\.com)(\/v1\/search\?)(.*)(storefrontID=[\d]{6})(.*) $1$2$3storefrontID=143441$5 header

[Script]
http-request ^https?:\/\/news-(edge|events)\.apple\.com(\/v1\/configs|\/analyticseventsv2\/async) script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_News.js, requires-body=true, timeout=10, tag=Apple_News

[MITM]
hostname = %APPEND% news-client.apple.com, news-client-search.apple.com, news-edge.apple.com, news-events.apple.com, newsletter-edge.apple.com
